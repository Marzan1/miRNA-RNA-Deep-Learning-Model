# BioSeq-AffinityPredict: A Deep Learning Framework for Predicting miRNA-Target Affinity

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Python Version](https://img.shields.io/badge/python-3.9+-blue.svg)](https://www.python.org/downloads/)
[![Framework: TensorFlow](https://img.shields.io/badge/TensorFlow-2.x-FF6F00.svg)](https://www.tensorflow.org/)
[![Code style: black](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/psf/black)

A research-grade, deep learning tool for predicting the binding affinity of microRNAs (miRNAs) to a specific RNA target, explicitly modeling the competitive effects of other molecules. This framework is designed to accelerate the discovery of novel therapeutic candidates in RNA-centric biological systems.

---

## Abstract

The regulation of gene expression by microRNAs (miRNAs) is a fundamental biological process, and the dysregulation of these interactions is implicated in numerous diseases. Computational prediction of miRNA-target binding affinity is a critical step in identifying therapeutic candidates. However, existing models often oversimplify the complex cellular environment. This project, **BioSeq-AffinityPredict**, introduces a novel multi-input deep learning model that performs a regression task to predict a continuous binding affinity score. Critically, our framework utilizes an "augmented pairs" data strategy to explicitly model the contextual influence of known protein or RNA competitors, providing a more nuanced and biologically relevant prediction. This tool is designed to be a scalable, robust, and accessible platform for researchers to rank large libraries of miRNAs against specific targets of interest.

---

## Key Features

-   **🔬 Regression-Based Prediction:** Predicts a continuous, fractional affinity score for more precise and detailed analysis than simple binary (bind/no-bind) classification.
-   **🏆 Explicit Competition Modeling:** Uniquely quantifies the inhibitory effect of a competitor molecule (e.g., a protein like REV) on the primary miRNA-target interaction.
-   **🧠 Multi-Input CNN Architecture:** Fuses five distinct data modalities—three sequences (miRNA, Target, Competitor), a predicted structure vector, and biophysical features—for a holistic prediction.
-   **⚙️ Scalable & Memory-Safe:** The entire data preparation pipeline is engineered to handle massive datasets by streaming data in chunks and saving intermediate files in the highly efficient Parquet format.
-   **🧬 Flexible & Generalizable:** While developed using the HIV RRE/REV system, the framework is designed to be easily adapted for any miRNA-Target-Competitor system.

---

## Project Structure

A well-structured repository is key to usability.

```
your-repository/
├── codes/                      # All Python scripts (1-5)
│   ├── 1_dataset_preparation.py
│   ├── 2_deep_learning_data_preparation.py
│   ├── 3_model_building.py
│   ├── 4_find_best_mirnas.py
│   └── 5_evaluate_and_visualize.py
├── dataset_sample/             # A small, sample dataset to test the pipeline
│   ├── affinity_score/select/
│   ├── competitor/select/
│   ├── conservation_score/select/
│   ├── miRNA_dataset/select/
│   └── target/select/
├── .gitignore                  # Specifies which files/folders Git should ignore
├── LICENSE
└── README.md
```
**Note:** The full `dataset/`, `models/`, `prediction/`, and `logs/` folders are generated by the scripts and are correctly ignored by `.gitignore`.

---

## Installation

This project requires Python 3.9+ and the ViennaRNA package.

1.  **Clone the Repository:**
    ```bash
    git clone https://github.com/aamarzan/miRNA-RNA-Deep-Learning-Model.git
    cd YOUR_REPOSITORY
    ```

2.  **Create and Activate a Virtual Environment (Recommended):**
    ```bash
    python -m venv venv
    source venv/bin/activate  # On Windows: venv\Scripts\activate
    ```

3.  **Install Required Python Packages:**
    ```bash
    pip install -r requirements.txt
    ```
    *(Note: Create this file with `pip freeze > requirements.txt` after installing all necessary libraries like `tensorflow`, `pandas`, `pyarrow`, `scikit-learn`, `biopython`, `seaborn`)*

4.  **Install ViennaRNA Package:**
    This project requires `RNAfold` for structure prediction. Please download and install the [ViennaRNA Package](https://www.tbi.univie.ac.at/RNA/ViennaRNA/doc/html/install.html) and ensure the `RNAfold` command is accessible in your system's PATH.

---

## Usage: End-to-End Workflow

Follow these steps to generate a dataset, train a model, and make predictions.

#### Step 1: Data Curation & Configuration
Place your raw data files (`.fasta`, `.csv`, etc.) into the appropriate subdirectories within a main `dataset/` folder, following the structure shown in `dataset_sample/`. The scripts will automatically look inside the `select/` subfolders.

#### Step 2: Generate the Master Dataset
This script reads all raw data, engineers features, creates all `(miRNA x Target x Competitor)` combinations (including a "no-competitor" baseline), and generates a single, efficient Parquet file.

```bash
python codes/1_dataset_preparation.py
```

#### Step 3: Prepare Data for Deep Learning
This script processes the Parquet file into NumPy arrays (`.npy`) that the model can use for training. It handles scaling, encoding, and splitting the data into training and testing sets.

```bash
python codes/2_deep_learning_data_preparation.py
```

#### Step 4: Train the Model
This script builds the CNN architecture and trains the regression model on the prepared data. It uses a memory-safe `DataGenerator` to handle large datasets and automatically saves the best-performing model to the `models/` directory.

```bash
python codes/3_model_building.py
```

#### Step 5: Rank New miRNAs
Use your trained model to predict the affinity of new candidate miRNAs.
1.  Create a `prediction/` folder in your project root.
2.  Inside `prediction/`, create three subfolders: `targets_to_predict`, `competitor_to_compare`, and `mirnas_to_rank`.
3.  Place the corresponding FASTA files in these folders.

Then, run the prediction script:
```bash
python codes/4_find_best_mirnas.py
```
The results will be saved as a Parquet file in the `prediction/` folder.

#### Step 6: Evaluate Model Performance
After training is complete, run this script to generate a full suite of publication-quality plots and statistical reports.

```bash
python codes/5_evaluate_and_visualize.py
```
All outputs will be saved to a timestamped folder inside `models/`.

---

## Handling the Full Dataset

The full dataset used for this research is not stored on GitHub due to its large size. A small `dataset_sample/` is provided to ensure the code is runnable out-of-the-box.

The complete dataset and the final trained model weights used in our study will be made publicly available on a permanent data repository (Zenodo) upon the acceptance of our manuscript for publication.

---

## Citing this Work

If you use this model or code in your research, please cite our work.
*(A full citation to our paper will be provided here upon publication.)*

## Contributing

Contributions, issues, and feature requests are highly welcome! If you have suggestions for improvements, encounter bugs, or wish to add new features, please feel free to open an issue or submit a pull request.

## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.

## Contact

Abdullah Al Marzan - [aamarzan](https://github.com/aamarzan) - marzansust16@gmail.com
